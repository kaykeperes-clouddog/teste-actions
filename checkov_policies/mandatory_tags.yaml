metadata:
  id: CUSTOM_AWS_TAGS_1
  name: "Ensure mandatory tags are present"
  category: "TAGGING"

scope:
  provider: aws

definition:
  and:
    - cond_type: attribute
      resource_types:
        - aws_s3_bucket
        - aws_security_group
        - aws_ebs_volume
        - aws_db_instance
        - aws_rds_cluster
        - aws_rds_global_cluster
        - aws_db_snapshot
        - aws_iam_role
        - aws_iam_group
        - aws_iam_policy
        - aws_iam_user
        - aws_ecs_cluster
        - aws_ecs_task_definition
        - aws_ecs_service
        - aws_eks_cluster
        - aws_cloudwatch_log_group
        - aws_cloudfront_distribution
        - aws_lambda_function
        - aws_instance
        - aws_elasticache_cluster
        - aws_ecr_repository
        - aws_efs_file_system
        - aws_redshift_cluster
        - aws_elasticsearch_domain
        - aws_docdb_cluster
        - aws_globalaccelerator_accelerator
        - aws_codebuild_project
        - aws_ssm_document
        - aws_subnet
        - aws_lb
        - aws_lb_target_group
        - aws_backup_vault
      attribute: tags
      operator: exists

    - cond_type: attribute
      attribute: tags.Project
      operator: exists
    - cond_type: attribute
      attribute: tags.Environment
      operator: exists
    - cond_type: attribute
      attribute: tags.Owner
      operator: exists
    - cond_type: attribute
      attribute: tags.CostCenter
      operator: exists
    - cond_type: attribute
      attribute: tags.Manage_by
      operator: exists